# 허브

통신 매체를 통해 송수신되는 메시지는 다른 호스트에게 전달되는 과정에서 네트워크 장비를 거칠 수 있다.
대표적인 네트워크 장비로 물리 계층에 '허브'가 있고, 데이터 링크 계층에는 '스위치'가 있다.

### 허브란?
허브는 여러 대의 호스트를 연결하는 장치이다.
'리피터 허브'(repeater hub)라 부르기도 하고,
이더넷 네트워크의 허븐느 이더넷 허브라고도 한다.

![HUB](https://upload.wikimedia.org/wikipedia/commons/thumb/d/d9/4_port_netgear_ethernet_hub.jpg/460px-4_port_netgear_ethernet_hub.jpg)

위 사진에서 커넥터를 연결할 수 있는 네 개의 연결 지점을 '포트'(port)라 한다.
포트에 호스트와 연결된 통신 매체를 연결할 수 있다.

### 허브의 특징
오늘날 인터넷 환경에서는 잘 사용되지 않는다.

1. 전달받은 신호를 다른 모든 포트로 그대로 다시 내보낸다.
허브는 물리 계층에 속한 장비이고, 물리 계층에는 주소 개념이 없기에 허브는 수신지를 특정할 수 없다.
따라서 신호를 전달 받으면 어떤 조작이나 판단을 하지않고 송신지를 제외한 모든 포트에 그저 내보내기만 한다.

허브를 통해 이 신호를 받은 모든 호스트는 데이터 링크 계층에서 패킷의 MAC 주소를 확인하고 자신과 관련 없는 주소는 폐기한다.

2. 반이중 모드로 통신한다.


### 주소 개념이 없는 물리 계층
물리 계층에는 주소 개념이없다.
송수신지를 특정할 수 있는 주소는 데이터 링크 계층부터 존재하는 개념이기에,
물리 계층에서는 단지 호스트와 통신 매체 간의 연결과 통신 매체상의 송수신이 이루어질 뿐이다.

그렇기에 물리 계층의 네트워크 장비는 송수신 되는 정보에 대한 어떠한 조작(송수신 내용 변경)이나 판단을 하지않는다.

반면 데이터 링크 계층엔 주소 개념이 존재한다.
바로 MAC 주소가 여기에 포함된다.
따라서 데이터 링크 계층의 장비나 그이상의 계층들의 장비는 송수신지를 특정할 수 있고, 송수신되는 정보에 대한 조작과 판단을 할 수 있다.

## 허브 동작 방식

![통신회선와 구조](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FrbAGW%2FbtqKvReRpwr%2FrneKJ9oE08YoLRnHfGsBDk%2Fimg.png)
참고: https://hoban123.tistory.com/141

- 반이중 모드 통신: 양방향의 정보 통신은 가능하나 동시에 통신은 불가하며 송신과 수신이 번갈아가며 소통 / ex) 무전기

- 전이중 모드 통신: 양방향 정보 통신이 동시에 가능하며 반이중에 비해 효율은 좋지만 회선 비용이 많이 소모한다.

- 콜리전 도메인
허브는 반이중 통신을 지원한다고 설명했는데,
한 호스트가 허브에 송신하는 동안 다른 호스트는 송신하고 싶어도 기다려야한다.

만일 동시에 허브에 신호를 송신하면 어떻게 될까 ?
충돌(Collision)이 발생한다.

허브에 호스트가 많이 연결되어 있을수록 충돌 발생 가능성이 높아지며,
불시에 다른 호스트가 허브로 신호를 송신할 수 있기 때문이다
이렇게 충돌이 발생 가능한 영역을 콜리전 도메인(Collision domain)이라 한다.

허브에 연결된 모든 호스트는 같은 콜리전 도메인에 속한다.

- CSMA/CD
결국 허브에서 충돌이 발생하는건 허브가 반이중 모드 통신을 사용하기 때문인데
이런 충돌 문제를 해결하는게 CSMA/CD이다.
Carrier Sense Multiple Access with Collision Detection의 약자이다.

1. CS, Carrier Sense 캐리어 감지
반이중 이더넷 네트워크에서 메시지를 보내기 전에 현재 네트워크상에 전송 중인 것이 있는지 먼저 확인한다.
현재 통신 매체의 사용 가능 여부를 검사하는 것 이를 '캐리어 감지'라 한다.

2. MA, Multiple Access 다중 접근
때로 캐리어 감지를 하는데도 두 개 이상의 호스트가 부득이하게 동시에 너트워크를 사용하려 할때가 있다.
복수의 호스트가 네트워크에 접근하려는 상황을 다중 접근이라 한다.
이때 충돌이 발생한다.

3. CD, Collision Detection 충돌 검출
충돌을 감지하면 전송이 중단되고 충돌을 검출한 호스트는 다른 이들에게 충돌이 발생했음을 알리고자 '잼 신호'(jam signal)라는 특별한 신호를 보낸다.
그리고 임의의 시간동안 기다린 후 다시 전송한다.


